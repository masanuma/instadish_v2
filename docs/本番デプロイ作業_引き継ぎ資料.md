# InstaDish Pro 本番デプロイ作業 引き継ぎ資料

**作成日**: 2024年12月19日  
**作業者**: AI Assistant  
**対象**: 本番デプロイ問題の解決作業

---

## 1. 本日の作業内容

### 1.1 問題の特定
- **Gitリモート設定確認**  
  - 正しく `masanuma/instadish_v2` リポジトリに設定済み

- **作業ブランチ確認**  
  - 元々 `master` ブランチで作業していた
  - 本番Railwayは `main` ブランチのみ監視

- **ファイルのGit管理状況確認**  
  - `src/app/admin/login/page.tsx` など必要ファイルが存在し、Git管理下にあることを確認

### 1.2 解決作業
- **masterブランチの内容をコミット・PUSH**  
  - すべての変更を `master` にコミットし、`origin/master` にPUSH

- **mainブランチの作成・切り替え・マージ**  
  - `main` ブランチをローカルで作成し、`master` の内容を `main` にマージ（履歴の違いも許可）
  - マージコンフリクトは「master優先」で解決し、コミット

- **mainブランチをGitHubにPUSH**  
  - `origin/main` にPUSHし、mainブランチが最新状態であることを確認

- **作業ディレクトリがクリーンな状態であることを確認**  
  - `git status` で「nothing to commit, working tree clean」

---

## 2. 明日以降の作業・確認ポイント

### 2.1 GitHubのmainブランチ確認
- [ ] `https://github.com/masanuma/instadish_v2` の mainブランチに、必要なファイル（例: `src/app/admin/login/page.tsx`）が存在しているか確認

### 2.2 Railwayのデプロイ状況確認
- [ ] Railwayの「Deployments」タブで、mainブランチの最新コミットで自動デプロイが走っているか確認
- [ ] デプロイに失敗していないか、エラーが出ていないか確認

### 2.3 本番環境の動作確認
- [ ] `/admin/login` など、問題となっていたページ・APIが本番で正しく動作するか確認

### 2.4 もし問題があれば
- [ ] エラーメッセージや状況を記録し、再度調査・修正
- [ ] 必要に応じて、`main` ブランチで修正→コミット→PUSH→デプロイ

---

## 3. 注意事項・運用ルール（再掲）

### 3.1 本番運用ルール
- **本番は「instadish_v2」リポジトリの「main」ブランチのみ**
- **masterで作業した場合は、必ずmainにマージしてからPUSH**
- **Gitリモート設定（git remote -v）でPUSH先を常に確認**

### 3.2 環境固有の注意点
- **Windows環境ではディレクトリ名・ファイル名の大文字小文字に注意**
- **どうしても反映されない場合は、GitHubのWeb UIで手動アップロードも有効**

### 3.3 禁止事項
- **v3リポジトリやブランチは絶対に使わない**

---

## 4. トラブル時のチェックリスト

### 4.1 Git関連
- [ ] GitHubのリポジトリ・ブランチが正しいか
- [ ] PUSH後、GitHubの「main」ブランチに最新ファイルが反映されているか
- [ ] ローカルのブランチ名が正しいか（mainブランチで作業しているか）

### 4.2 Railway関連
- [ ] Railwayの「Settings」→「Integrations」で連携先を確認
- [ ] Railwayのデプロイ履歴で「main」ブランチのコミットがトリガーになっているか

### 4.3 アプリケーション関連
- [ ] 本番で404やAPIエラーが出た場合は、ファイル配置・大文字小文字・APIルートの有無を再確認

---

## 5. 次回作業担当者へのメッセージ

- 何か不明点やエラーがあれば、上記の「確認ポイント」を順にチェックしてください。
- 状況を記録し、必要に応じてAIや他のメンバーに相談してください。
- このドキュメントを更新して、新しい問題や解決策を記録してください。

---

## 6. 参考リンク

- **GitHubリポジトリ**: https://github.com/masanuma/instadish_v2
- **Railwayダッシュボード**: Railwayのプロジェクトダッシュボード
- **本番環境**: Railwayでデプロイされた本番URL

---

**更新履歴**:
- 2024/12/19: 初版作成（本番デプロイ問題解決作業の記録） 